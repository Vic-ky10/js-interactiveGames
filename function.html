<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rock Paper Scissors</title>
  </head>
  <body>
    <script>
      const initGame = () => {
        const startGame = confirm("Shall we play rock, paper, or scissors?");
        startGame ? playGame() : alert("Ok, maybe next time.");
      };

      const playGame = () => {
        while (true) {
          let playerChoice = getPlayerChoice();
          playerChoice = formatPlayerChoice(playerChoice);

          if (playerChoice === "") {
            invalidChoice();
            continue;
          }

          if (!playerChoice) {
            decideNotToPlay();
            break;
          }

          playerChoice = evaluatePlayerChoice(playerChoice);
          if (!playerChoice) {
            invalidChoice();
            continue;
          }

          const computerChoice = getComputerChoice();
          const result = determineWinner(playerChoice, computerChoice);
          displayResult(result);

          if (!askToPlayAgain()) {
            thanksForPlaying();
            break;
          }
        }
      };

      const getPlayerChoice = () => {
        return prompt("Please enter rock, paper, or scissors.");
      };

      const formatPlayerChoice = (playerChoice) => {
        return playerChoice ? playerChoice.trim().toLowerCase() : false;
      };

      const decideNotToPlay = () => {
        alert("I guess you changed your mind. Maybe next time.");
      };

      const evaluatePlayerChoice = (choice) => {
        return ["rock", "paper", "scissors"].includes(choice) ? choice : false;
      };

      const invalidChoice = () => {
        alert("You didn't enter rock, paper, or scissors.");
      };

      const getComputerChoice = () => {
        const rpsArray = ["rock", "paper", "scissors"];
        return rpsArray[Math.floor(Math.random() * 3)];
      };

      const determineWinner = (player, computer) => {
        if (player === computer) return "Tie game!";

        if (
          (player === "rock" && computer === "scissors") ||
          (player === "paper" && computer === "rock") ||
          (player === "scissors" && computer === "paper")
        ) {
          return `Player: ${player}\nComputer: ${computer}\nYou win!`;
        }

        return `Player: ${player}\nComputer: ${computer}\nComputer wins!`;
      };

      const displayResult = (result) => {
        alert(result);
      };

      const askToPlayAgain = () => {
        return confirm("Play again?");
      };

      const thanksForPlaying = () => {
        alert("Thanks for playing!");
      };

      initGame();
    </script>
  </body>
</html>
